#!/bin/bash
#SBATCH --job-name=gtex_subset          # Job name
#SBATCH --mail-user=avannan@asu.edu    # Send-to address
#SBATCH -n 1                           # Number of tasks per node (N)
#SBATCH -o slurm.%j.out                # STDOUT (%j = JobId)
#SBATCH -e slurm.%j.err                # STDERR (%j = JobId)
#SBATCH --qos=normal                   # Quality of service (priority)
#SBATCH -t 0-2:00                      # Maximum wall time (D-HH:MM)

###
### This script gets a subset of genes from the GTEX brain files
###

# Go to directory
cd /scratch/avannan/TTR/counts/

# Set brain tissue files
brain_tissues=(Brain-Amygdala Brain-Anteriorcingulatecortex_BA24 Brain-Caudate_basalganglia Brain-CerebellarHemisphere \
Brain-Cerebellum Brain-Cortex Brain-FrontalCortex_BA9 Brain-Hippocampus Brain-Hypothalamus Brain-Nucleusaccumbens_basalganglia \
Brain-Putamen_basalganglia Brain-Spinalcord_cervicalc-1 Brain-Substantianigra Pituitary)

# Subset brain tissue files by genes of interest
for tissue in ${brain_tissues[@]}; do
  echo "START Subsetting genes for tissue: ${tissue}"
  awk 'NR==1; \
  # Engeln
  $1 ~ "ENSG00000183760"; $1 ~ "ENSG00000072110"; $1 ~ "ENSG00000155897"; \
  $1 ~ "ENSG00000197177"; $1 ~ "ENSG00000170214"; $1 ~ "ENSG00000135744"; \
  $1 ~ "ENSG00000179841"; $1 ~ "ENSG00000029534"; $1 ~ "ENSG00000170209"; \
  $1 ~ "ENSG00000164236"; $1 ~ "ENSG00000235711"; $1 ~ "ENSG00000230778"; \
  $1 ~ "ENSG00000134343"; $1 ~ "ENSG00000134909"; $1 ~ "ENSG00000047648"; \
  $1 ~ "ENSG00000172995"; $1 ~ "ENSG00000108684"; $1 ~ "ENSG00000169020"; \
  $1 ~ "ENSG00000169020"; $1 ~ "ENSG00000101200"; $1 ~ "ENSG00000166886"; \
  $1 ~ "ENSG00000175866"; $1 ~ "ENSG00000151136"; $1 ~ "ENSG00000144119"; \
  $1 ~ "ENSG00000154975"; $1 ~ "ENSG00000074410"; $1 ~ "ENSG00000100314"; \
  $1 ~ "ENSG00000198216"; $1 ~ "ENSG00000081803"; $1 ~ "ENSG00000172137"; \
  $1 ~ "ENSG00000008118"; $1 ~ "ENSG00000163888"; $1 ~ "ENSG00000152495"; \
  $1 ~ "ENSG00000137225"; $1 ~ "ENSG00000260220"; $1 ~ "ENSG00000118971"; \
  $1 ~ "ENSG00000112149"; $1 ~ "ENSG00000158825"; $1 ~ "ENSG00000081138"; \
  $1 ~ "ENSG00000058091"; $1 ~ "ENSG00000117266"; $1 ~ "ENSG00000288642"; \
  $1 ~ "ENSG00000048740"; $1 ~ "ENSG00000161082"; $1 ~ "ENSG00000168539"; \
  $1 ~ "ENSG00000182022"; $1 ~ "ENSG00000124302"; $1 ~ "ENSG00000136425"; \
  $1 ~ "ENSG00000149970"; $1 ~ "ENSG00000106078"; $1 ~ "ENSG00000215018"; \
  $1 ~ "ENSG00000142156"; $1 ~ "ENSG00000106789"; $1 ~ "ENSG00000109265"; \
  $1 ~ "ENSG00000058453"; $1 ~ "ENSG00000103316"; $1 ~ "ENSG00000077063"; \
  $1 ~ "ENSG00000163673"; $1 ~ "ENSG00000102780"; $1 ~ "ENSG00000157680"; \
  $1 ~ "ENSG00000147202"; $1 ~ "ENSG00000137094"; $1 ~ "ENSG00000198010"; \
  $1 ~ "ENSG00000142700"; $1 ~ "ENSG00000011332"; $1 ~ "ENSG00000178904"; \
  $1 ~ "ENSG00000184845"; $1 ~ "ENSG00000171587"; $1 ~ "ENSG00000276023"; \
  $1 ~ "ENSG00000276023"; $1 ~ "ENSG00000120738"; $1 ~ "ENSG00000122877"; \
  $1 ~ "ENSG00000179388"; $1 ~ "ENSG00000135625"; $1 ~ "ENSG00000116299"; \
  $1 ~ "ENSG00000225968"; $1 ~ "ENSG00000083782"; $1 ~ "ENSG00000107566"; \
  $1 ~ "ENSG00000242950"; $1 ~ "ENSG00000244405"; $1 ~ "ENSG00000164434"; \
  $1 ~ "ENSG00000185519"; $1 ~ "ENSG00000197852"; $1 ~ "ENSG00000111913"; \
  $1 ~ "ENSG00000086570"; $1 ~ "ENSG00000118407"; $1 ~ "ENSG00000172568"; \
  $1 ~ "ENSG00000125740"; $1 ~ "ENSG00000075426"; $1 ~ "ENSG00000150907"; \
  $1 ~ "ENSG00000114861"; $1 ~ "ENSG00000128573"; $1 ~ "ENSG00000138759"; \
  $1 ~ "ENSG00000168843"; $1 ~ "ENSG00000141349"; $1 ~ "ENSG00000109158"; \
  $1 ~ "ENSG00000268089"; $1 ~ "ENSG00000069482"; $1 ~ "ENSG00000164900"; \
  $1 ~ "ENSG00000119125"; $1 ~ "ENSG00000130055"; $1 ~ "ENSG00000131095"; \
  $1 ~ "ENSG00000121853"; $1 ~ "ENSG00000283586"; $1 ~ "ENSG00000111087"; \
  $1 ~ "ENSG00000145888"; $1 ~ "ENSG00000277399"; $1 ~ "ENSG00000146360"; \
  $1 ~ "ENSG00000211445"; $1 ~ "ENSG00000215045"; $1 ~ "ENSG00000105464"; \
  $1 ~ "ENSG00000134443"; $1 ~ "ENSG00000126010"; $1 ~ "ENSG00000187664"; \
  $1 ~ "ENSG00000138622"; $1 ~ "ENSG00000163909"; $1 ~ "ENSG00000095951"; \
  $1 ~ "ENSG00000010818"; $1 ~ "ENSG00000152413"; $1 ~ "ENSG00000115756"; \
  $1 ~ "ENSG00000135312"; $1 ~ "ENSG00000179097"; $1 ~ "ENSG00000148680"; \
  $1 ~ "ENSG00000142149"; $1 ~ "ENSG00000105376"; $1 ~ "ENSG00000147255"; \
  $1 ~ "ENSG00000122641"; $1 ~ "ENSG00000197852"; $1 ~ "ENSG00000145703"; \
  $1 ~ "ENSG00000133124"; $1 ~ "ENSG00000162267"; $1 ~ "ENSG00000143772"; \
  $1 ~ "ENSG00000107821"; $1 ~ "ENSG00000182255"; $1 ~ "ENSG00000130037"; \
  $1 ~ "ENSG00000166006"; $1 ~ "ENSG00000116396"; $1 ~ "ENSG00000055118"; \
  $1 ~ "ENSG00000182132"; $1 ~ "ENSG00000120049"; $1 ~ "ENSG00000123700"; \
  $1 ~ "ENSG00000169427"; $1 ~ "ENSG00000185760"; $1 ~ "ENSG00000164794"; \
  $1 ~ "ENSG00000134504"; $1 ~ "ENSG00000183775"; $1 ~ "ENSG00000006459"; \
  $1 ~ "ENSG00000109265"; $1 ~ "ENSG00000116299"; $1 ~ "ENSG00000126259"; \
  $1 ~ "ENSG00000155090"; $1 ~ "ENSG00000162873"; $1 ~ "ENSG00000150361"; \
  $1 ~ "ENSG00000146021"; $1 ~ "ENSG00000171403"; $1 ~ "ENSG00000011376"; \
  $1 ~ "ENSG00000197753"; $1 ~ "ENSG00000089116"; $1 ~ "ENSG00000162624"; \
  $1 ~ "ENSG00000106683"; $1 ~ "ENSG00000136153"; $1 ~ "ENSG00000175445"; \
  $1 ~ "ENSG00000033122"; $1 ~ "ENSG00000178026"; $1 ~ "ENSG00000188906"; \
  $1 ~ "ENSG00000198739"; $1 ~ "ENSG00000150556"; $1 ~ "ENSG00000143669"; \
  $1 ~ "ENSG00000061337"; $1 ~ "ENSG00000133315"; $1 ~ "ENSG00000111885"; \
  $1 ~ "ENSG00000112893"; $1 ~ "ENSG00000073803"; $1 ~ "ENSG00000105613"; \
  $1 ~ "ENSG00000175471"; $1 ~ "ENSG00000081189"; $1 ~ "ENSG00000165171"; \
  $1 ~ "ENSG00000165171"; $1 ~ "ENSG00000186260"; $1 ~ "ENSG00000108960"; \
  $1 ~ "ENSG00000102996"; $1 ~ "ENSG00000186260"; $1 ~ "ENSG00000198712"; \
  $1 ~ "ENSG00000198938"; $1 ~ "ENSG00000242114"; $1 ~ "ENSG00000167306"; \
  $1 ~ "ENSG00000182636"; $1 ~ "ENSG00000049759"; $1 ~ "ENSG00000100285"; \
  $1 ~ "ENSG00000166342"; $1 ~ "ENSG00000165553"; $1 ~ "ENSG00000064300"; \
  $1 ~ "ENSG00000100503"; $1 ~ "ENSG00000148826"; $1 ~ "ENSG00000130751"; \
  $1 ~ "ENSG00000185551"; $1 ~ "ENSG00000123358"; $1 ~ "ENSG00000119508"; \
  $1 ~ "ENSG00000171119"; $1 ~ "ENSG00000182379"; $1 ~ "ENSG00000105088"; \
  $1 ~ "ENSG00000184221"; $1 ~ "ENSG00000091039"; $1 ~ "ENSG00000171540"; \
  $1 ~ "ENSG00000169860"; $1 ~ "ENSG00000079462"; $1 ~ "ENSG00000160781"; \
  $1 ~ "ENSG00000186642"; $1 ~ "ENSG00000171408"; $1 ~ "ENSG00000101327"; \
  $1 ~ "ENSG00000133401"; $1 ~ "ENSG00000242265"; $1 ~ "ENSG00000197329"; \
  $1 ~ "ENSG00000179094"; $1 ~ "ENSG00000132326"; $1 ~ "ENSG00000174307"; \
  $1 ~ "ENSG00000057294"; $1 ~ "ENSG00000114805"; $1 ~ "ENSG00000240891"; \
  $1 ~ "ENSG00000145632"; $1 ~ "ENSG00000148123"; $1 ~ "ENSG00000117600"; \
  $1 ~ "ENSG00000168081"; $1 ~ "ENSG00000196767"; $1 ~ "ENSG00000184203"; \
  $1 ~ "ENSG00000231989"; $1 ~ "ENSG00000231989"; $1 ~ "ENSG00000027075"; \
  $1 ~ "ENSG00000113494"; $1 ~ "ENSG00000244694"; $1 ~ "ENSG00000100362"; \
  $1 ~ "ENSG00000048991"; $1 ~ "ENSG00000169213"; $1 ~ "ENSG00000077092"; \
  $1 ~ "ENSG00000112183"; $1 ~ "ENSG00000054967"; $1 ~ "ENSG00000182698"; \
  $1 ~ "ENSG00000165731"; $1 ~ "ENSG00000080298"; $1 ~ "ENSG00000169220"; \
  $1 ~ "ENSG00000116741"; $1 ~ "ENSG00000174791"; $1 ~ "ENSG00000111913"; \
  $1 ~ "ENSG00000172602"; $1 ~ "ENSG00000116745"; $1 ~ "ENSG00000108107"; \
  $1 ~ "ENSG00000108107"; $1 ~ "ENSG00000171858"; $1 ~ "ENSG00000171858"; \
  $1 ~ "ENSG00000177189"; $1 ~ "ENSG00000171863"; $1 ~ "ENSG00000163220"; \
  $1 ~ "ENSG00000119042"; $1 ~ "ENSG00000075223"; $1 ~ "ENSG00000143434"; \
  $1 ~ "ENSG00000170054"; $1 ~ "ENSG00000180440"; $1 ~ "ENSG00000116560"; \
  $1 ~ "ENSG00000120057"; $1 ~ "ENSG00000181523"; $1 ~ "ENSG00000189410"; \
  $1 ~ "ENSG00000156463"; $1 ~ "ENSG00000105251"; $1 ~ "ENSG00000170145"; \
  $1 ~ "ENSG00000091664"; $1 ~ "ENSG00000182902"; $1 ~ "ENSG00000181045"; \
  $1 ~ "ENSG00000164638"; $1 ~ "ENSG00000182747"; $1 ~ "ENSG00000088836"; \
  $1 ~ "ENSG00000105641"; $1 ~ "ENSG00000132164"; $1 ~ "ENSG00000196517"; \
  $1 ~ "ENSG00000130876"; $1 ~ "ENSG00000178235"; $1 ~ "ENSG00000130768"; \
  $1 ~ "ENSG00000173267"; $1 ~ "ENSG00000154556"; $1 ~ "ENSG00000158792"; \
  $1 ~ "ENSG00000153820"; $1 ~ "ENSG00000229453"; $1 ~ "ENSG00000139874"; \
  $1 ~ "ENSG00000101638"; $1 ~ "ENSG00000134602"; $1 ~ "ENSG00000104435"; \
  $1 ~ "ENSG00000128578"; $1 ~ "ENSG00000163630"; $1 ~ "ENSG00000110975"; \
  $1 ~ "ENSG00000019505"; $1 ~ "ENSG00000103528"; $1 ~ "ENSG00000143858"; \
  $1 ~ "ENSG00000134207"; $1 ~ "ENSG00000102362"; $1 ~ "ENSG00000006128"; \
  $1 ~ "ENSG00000166863"; $1 ~ "ENSG00000146426"; $1 ~ "ENSG00000181234"; \
  $1 ~ "ENSG00000167619"; $1 ~ "ENSG00000178233"; $1 ~ "ENSG00000152154"; \
  $1 ~ "ENSG00000124191"; $1 ~ "ENSG00000183763"; $1 ~ "ENSG00000048140"; \
  $1 ~ "ENSG00000175567"; $1 ~ "ENSG00000107731"; $1 ~ "ENSG00000139190"; \
  $1 ~ "ENSG00000114812"; $1 ~ "ENSG00000110002"; $1 ~ "ENSG00000112290"; \
  $1 ~ "ENSG00000165171"; $1 ~ "ENSG00000109501"; $1 ~ "ENSG00000095397"; \
  $1 ~ "ENSG00000122574"; $1 ~ "ENSG00000175155"; $1 ~ "ENSG00000146839"; \
  $1 ~ "ENSG00000204186"; $1 ~ "ENSG00000102935"; $1 ~ "ENSG00000124203"; \
  $1 ~ "ENSG00000285708"; $1 ~ "ENSG00000285868"; $1 ~ "ENSG00000266997"; \
  $1 ~ "ENSG00000258989"' \
  ${tissue}_counts.txt > subset_new_${tissue}.txt \
done
